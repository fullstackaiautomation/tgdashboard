# Story 1.3: Enhanced Content Card with AI Summary Display

**Epic**: AI-Powered Content Library Enhancement
**Story ID**: 1.3
**Priority**: High
**Estimated Effort**: Medium (4-5 hours)

---

## User Story

**As a** user browsing my content library,
**I want** to see AI-generated summaries and dashboard area tags on content cards,
**so that** I can quickly identify relevant content without opening each item.

---

## Acceptance Criteria

1. ✅ Extract ContentCard component from ContentLibrary.tsx for reusability
2. ✅ Add AI summary display (2-3 line truncation with line-clamp-2)
3. ✅ Display dashboard area chips below status/priority badges
4. ✅ Show value rating badge when present
5. ✅ Maintain existing: thumbnail, source icon, title, creator, status, priority, favorite star, quick actions
6. ✅ Card height adjusts dynamically based on content (supports masonry layout)
7. ✅ AI summary text styled in gray-400 for differentiation
8. ✅ Cards remain clickable to open details modal

---

## Integration Verification

**IV1**: Existing cards without ai_summary display correctly (shows only notes/description)
**IV2**: Grid layout remains responsive across all breakpoints
**IV3**: Card click handlers and quick actions continue working as before

---

## Technical Implementation Details

### Component Structure
```tsx
// src/components/content/ContentCard.tsx
interface ContentCardProps {
  content: ContentItem
  onToggleFavorite: (id: string, currentValue: boolean) => void
  onComplete: (id: string) => void
  onClick: (content: ContentItem) => void
}
```

### Card Layout
```tsx
<div className="bg-gray-800 rounded-lg shadow-lg border border-gray-700 overflow-hidden hover:shadow-xl hover:border-gray-600 transition-all cursor-pointer group"
     onClick={() => onClick(content)}>

  {/* Thumbnail Section */}
  <div className="relative aspect-video w-full bg-gray-900">
    {content.thumbnail_url ? (
      <img src={content.thumbnail_url} alt={content.title} className="w-full h-full object-cover" />
    ) : (
      <div className="flex items-center justify-center h-full">
        <span className="text-6xl opacity-20">{getSourceIcon(content.source)}</span>
      </div>
    )}
    <div className="absolute top-2 right-2">
      <button onClick={(e) => { e.stopPropagation(); onToggleFavorite(content.id, content.is_favorite) }}>
        <Star className={content.is_favorite ? "text-yellow-500 fill-yellow-500" : "text-white"} />
      </button>
    </div>
  </div>

  {/* Card Content */}
  <div className="p-4">
    {/* Title */}
    <div className="flex items-start gap-2 mb-2">
      <span className="text-xl">{getSourceIcon(content.source)}</span>
      <h3 className="text-base font-semibold text-white line-clamp-2">{content.title}</h3>
    </div>

    {/* Creator */}
    {content.creator && <p className="text-sm text-gray-400 mb-2">by {content.creator}</p>}

    {/* AI Summary (NEW) */}
    {content.ai_summary && (
      <p className="text-sm text-gray-400 mb-3 line-clamp-2">{content.ai_summary}</p>
    )}

    {/* Badges */}
    <div className="flex items-center gap-2 flex-wrap mb-3">
      <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs ${getStatusColor(content.status)}`}>
        {getStatusIcon(content.status)} {content.status}
      </span>
      <span className={`px-2 py-1 rounded-md text-xs border ${getPriorityColor(content.priority)}`}>
        {content.priority}
      </span>
      {content.time_to_consume && (
        <span className="inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs bg-gray-700 text-gray-300">
          <Clock className="w-3 h-3" /> {content.time_to_consume}m
        </span>
      )}
      {/* Value Rating Badge (NEW) */}
      {content.value_rating && (
        <span className="inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs bg-yellow-900 text-yellow-300 border border-yellow-700">
          ⭐ {content.value_rating}/10
        </span>
      )}
    </div>

    {/* Dashboard Area Chips (NEW) */}
    {content.dashboard_areas && content.dashboard_areas.length > 0 && (
      <div className="flex items-center gap-1 flex-wrap mb-3">
        {content.dashboard_areas.slice(0, 3).map(area => (
          <DashboardAreaChip key={area} areaId={area} />
        ))}
        {content.dashboard_areas.length > 3 && (
          <span className="text-xs text-gray-500">+{content.dashboard_areas.length - 3}</span>
        )}
      </div>
    )}

    {/* Category */}
    <div className="text-xs text-gray-500 mb-2">{content.category}</div>

    {/* Tags */}
    {content.tags.length > 0 && (
      <div className="flex items-center gap-1 flex-wrap mb-3">
        {content.tags.slice(0, 3).map(tag => (
          <span key={tag} className="inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs bg-blue-900 text-blue-300">
            <Tag className="w-3 h-3" /> {tag}
          </span>
        ))}
        {content.tags.length > 3 && <span className="text-xs text-gray-500">+{content.tags.length - 3}</span>}
      </div>
    )}

    {/* Action Buttons */}
    <div className="flex items-center gap-2 pt-3 border-t border-gray-700">
      <a href={content.url} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()}
         className="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors text-sm text-gray-300">
        <ExternalLink className="w-4 h-4" /> Open
      </a>
      {content.status !== 'Completed' && (
        <button onClick={(e) => { e.stopPropagation(); onComplete(content.id) }}
                className="px-3 py-2 bg-green-900 hover:bg-green-800 rounded-lg transition-colors text-sm text-green-300">
          <CheckCircle2 className="w-4 h-4" />
        </button>
      )}
    </div>
  </div>
</div>
```

### Dashboard Area Chip Helper Component
```tsx
// Small helper to display area chip with correct color
const DashboardAreaChip = ({ areaId }: { areaId: string }) => {
  // Check if it's a business ID (UUID) or life area (literal string)
  const isLifeArea = ['Health', 'Life', 'Finance', 'Golf'].includes(areaId)

  if (isLifeArea) {
    const colors = {
      Health: 'bg-green-900 text-green-300 border-green-700',
      Finance: 'bg-blue-900 text-blue-300 border-blue-700',
      Life: 'bg-purple-900 text-purple-300 border-purple-700',
      Golf: 'bg-yellow-900 text-yellow-300 border-yellow-700'
    }
    return (
      <span className={`px-2 py-1 rounded-md text-xs border ${colors[areaId]}`}>
        {areaId}
      </span>
    )
  } else {
    // Fetch business name and color from businesses data
    // ... implementation
  }
}
```

---

## UI Design Notes

### Typography
- Title: text-base font-semibold (line-clamp-2 for long titles)
- Creator: text-sm text-gray-400
- AI Summary: text-sm text-gray-400 (line-clamp-2)
- Category: text-xs text-gray-500

### Spacing
- p-4 padding on card content
- mb-2/mb-3 margins between sections
- gap-2 for badge rows
- gap-1 for chip rows

### Truncation
- Title: line-clamp-2 (2 lines max)
- AI Summary: line-clamp-2 (2 lines max, differentiates from notes)
- Tags: Show first 3, then "+N more"
- Dashboard Areas: Show first 3, then "+N more"

---

## Testing Checklist

- [ ] Card renders with all existing fields
- [ ] Card renders with ai_summary (truncated to 2 lines)
- [ ] Card renders without ai_summary (no errors)
- [ ] Dashboard area chips display with correct colors
- [ ] Value rating badge shows when rating exists
- [ ] Card height adjusts dynamically based on content
- [ ] Favorite button toggles correctly
- [ ] Complete button marks content as completed
- [ ] Open link button opens URL in new tab
- [ ] Card click opens details modal
- [ ] Responsive across all breakpoints (mobile, tablet, desktop)

---

## Dependencies

- DashboardAreaChip component (can be inline or separate)
- Existing icon helpers (getSourceIcon, getStatusIcon, getPriorityColor, getStatusColor)
- ContentItem type with new fields (ai_summary, dashboard_areas, value_rating)

---

## Files to Modify/Create

**New Files**:
- `src/components/content/ContentCard.tsx`

**Modified Files**:
- `src/components/ContentLibrary.tsx` (replace inline card JSX with <ContentCard /> component)
- `src/types/content.ts` (ensure ai_summary, dashboard_areas, value_rating are in ContentItem)

---

## Definition of Done

- [ ] ContentCard component extracted and created
- [ ] AI summary displays with proper truncation
- [ ] Dashboard area chips display with correct colors
- [ ] Value rating badge displays when present
- [ ] All existing functionality preserved
- [ ] Card height adjusts dynamically
- [ ] Responsive on all screen sizes
- [ ] All integration verification tests pass
- [ ] Code reviewed and merged

---

**Story Status**: Ready for Development
**Assigned To**: TBD
**Started**: TBD
**Completed**: TBD
