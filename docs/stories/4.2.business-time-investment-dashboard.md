# Story 4.2: Business-Level Time Investment Dashboard

## Status
Draft

## Story
**As a** consultant balancing 3 clients plus 2 personal ventures,
**I want** each Business page to show total time invested and ROI metrics,
**so that** I can ensure I'm allocating appropriate attention to each revenue stream.

## Acceptance Criteria
1. Each Business page displays "Time Invested" card at top showing:
   - Total hours (all-time)
   - Hours this week
   - Hours this month
   - Average hours per week over last 4 weeks
2. Business page shows time allocation breakdown by project within that business (pie chart or bar chart)
3. Time allocation vs. revenue tracking: "Huge Capital: 45h this month, $5K revenue = $111/hour effective rate"
4. Alert indicator if business has received zero hours for 7+ consecutive days: "⚠️ No time allocated this week"
5. Business comparison view shows all 5 businesses side-by-side with time investment bars for relative comparison
6. "Time Budget" feature allows setting target hours per business per week, with visual indicator showing actual vs. target
7. Historical time trends: line graph showing hours invested in each business over last 3 months
8. Labels within business (e.g., "New Build", "Bug Fix", "Client Meeting") show time breakdown for internal analysis

## Tasks / Subtasks
- [ ] Task 1: Create business-level time aggregation queries (AC: 1)
  - [ ] Create SQL function: get_business_time_stats(business_id) returns JSONB with all-time, week, month, avg_week hours
  - [ ] Query formula: SELECT SUM(duration_minutes) / 60.0 FROM deep_work_sessions WHERE business_id = ? GROUP BY time period
  - [ ] All-time hours: no date filter
  - [ ] This week: WHERE DATE(start_time) >= start_of_current_week
  - [ ] This month: WHERE DATE(start_time) >= start_of_current_month
  - [ ] Avg per week (4 weeks): SUM(hours last 4 weeks) / 4
  - [ ] Add index for performance: idx_deep_work_business_start on (business_id, start_time)
  - [ ] Cache results using React Query with 5-minute staleTime
- [ ] Task 2: Build TimeInvestedCard component (AC: 1)
  - [ ] Create src/components/business/TimeInvestedCard.tsx
  - [ ] Display 4 metrics in grid: All-Time | This Week | This Month | Avg/Week
  - [ ] Use large font size for primary metric (this week hours)
  - [ ] Show trend indicators: ↑ +2h vs last week (green) or ↓ -3h vs last week (red)
  - [ ] Loading skeleton while fetching data
  - [ ] Refresh button to manually refetch stats
  - [ ] Integrate into Business page header below business name
  - [ ] Responsive: stack metrics vertically on mobile
- [ ] Task 3: Build project-level time breakdown visualization (AC: 2)
  - [ ] Create src/components/business/ProjectTimeBreakdown.tsx
  - [ ] Query: SELECT project_id, SUM(duration_minutes) / 60.0 FROM deep_work_sessions WHERE business_id = ? GROUP BY project_id
  - [ ] Pie chart option: each project as colored slice (use Recharts PieChart)
  - [ ] Bar chart option: horizontal bars showing hours per project (better for many projects)
  - [ ] Toggle between pie/bar via button
  - [ ] Legend shows project names with colors
  - [ ] Click slice/bar → navigate to Project detail page
  - [ ] Show "No project assigned" as separate category for unassigned sessions
  - [ ] Filter by date range: this week, this month, last 3 months
- [ ] Task 4: Implement ROI tracking and effective rate calculation (AC: 3)
  - [ ] Add revenue_current_month column to businesses table (nullable NUMERIC)
  - [ ] Create src/components/business/ROICard.tsx
  - [ ] Display: "45h this month, $5,000 revenue = $111/hour effective rate"
  - [ ] Calculate: effective_rate = revenue_current_month / hours_this_month
  - [ ] Color-code rate: >$150/h green, $75-150/h yellow, <$75/h red
  - [ ] Allow editing revenue: click to open modal, enter amount, save to businesses.revenue_current_month
  - [ ] Handle edge cases: if revenue = 0, show "No revenue tracked", if hours = 0, show "No time logged"
  - [ ] Comparison: show effective rate vs. target rate (if set)
  - [ ] Historical trend: effective rate over last 6 months
- [ ] Task 5: Build zero-time alert system (AC: 4)
  - [ ] Create src/utils/businessTimeAlerts.ts utility
  - [ ] Check: last Deep Work session for business > 7 days ago
  - [ ] Query: SELECT MAX(start_time) FROM deep_work_sessions WHERE business_id = ?
  - [ ] If MAX(start_time) < NOW() - INTERVAL '7 days', trigger alert
  - [ ] Display alert banner on Business page: "⚠️ No time allocated this week"
  - [ ] Alert styling: yellow background, warning icon, prominent placement
  - [ ] "Schedule Time" CTA button → opens Daily page with business pre-selected
  - [ ] Alert also shown on Review dashboard: list all businesses with zero time
  - [ ] Dismissible: hide alert for 24h (store in localStorage)
- [ ] Task 6: Create business comparison view (AC: 5)
  - [ ] Create src/pages/BusinessComparison.tsx (new route: /business-comparison)
  - [ ] Table layout: rows = businesses, columns = All-Time, This Week, This Month, Trend
  - [ ] Bar chart: horizontal bars showing this week hours for all businesses side-by-side
  - [ ] Sort options: by most hours, by least hours, alphabetical
  - [ ] Highlight top business with gold badge, bottom business with red indicator
  - [ ] Total row: sum of all business hours
  - [ ] Click business row → navigate to that Business page
  - [ ] Export comparison as CSV
  - [ ] Link from main navigation: "Compare Businesses"
- [ ] Task 7: Implement time budget target system (AC: 6)
  - [ ] Add time_budget_hours_per_week column to businesses table (nullable INTEGER)
  - [ ] Create src/components/business/TimeBudgetIndicator.tsx
  - [ ] Display: "Target: 10h/week, Actual: 8h this week (80%)" with progress bar
  - [ ] Progress bar: green if >=100% of target, yellow if 75-99%, red if <75%
  - [ ] Allow setting target: click "Set Budget" → modal with numeric input
  - [ ] Save target to businesses.time_budget_hours_per_week
  - [ ] Show on Business page next to TimeInvestedCard
  - [ ] Review dashboard: aggregate all businesses showing target vs. actual
  - [ ] Weekly summary notification: "3 businesses below time budget this week"
- [ ] Task 8: Build historical time trend visualization (AC: 7)
  - [ ] Create src/components/business/HistoricalTimeTrend.tsx using Recharts LineChart
  - [ ] Query: SELECT DATE(start_time), SUM(duration_minutes) / 60.0 FROM deep_work_sessions WHERE business_id = ? AND start_time >= NOW() - INTERVAL '3 months' GROUP BY DATE(start_time)
  - [ ] X-axis: dates (last 90 days), Y-axis: hours per day
  - [ ] Line with area fill showing daily hours
  - [ ] Aggregate options: show daily, weekly, or monthly totals
  - [ ] Smooth curve using monotone interpolation
  - [ ] Tooltip shows exact date and hours on hover
  - [ ] Mark significant events: "Project launch", "Client onboarding" (annotations)
  - [ ] Export chart as PNG for reports
- [ ] Task 9: Implement label-based time breakdown (AC: 8)
  - [ ] Create src/components/business/LabelTimeBreakdown.tsx
  - [ ] Query: SELECT UNNEST(labels) as label, SUM(duration_minutes) / 60.0 FROM deep_work_sessions WHERE business_id = ? GROUP BY label
  - [ ] Display as horizontal bar chart: labels on Y-axis, hours on X-axis
  - [ ] Common labels: "Internal Build", "$$$ Printer $$$", "Client Meeting", "Bug Fix", "New Feature", "Admin"
  - [ ] Color-code: revenue-generating ($$$) in green, internal in blue, maintenance in gray
  - [ ] Filter by date range: this week, this month, last 3 months
  - [ ] Click label → filter Deep Work sessions to show only that label
  - [ ] Export label breakdown as CSV for internal analysis
  - [ ] Pie chart alternative showing % distribution across labels
- [ ] Task 10: Integrate all components into Business page layout (AC: all)
  - [ ] Update src/pages/Business.tsx to include new time tracking components
  - [ ] Layout: TimeInvestedCard at top (hero section)
  - [ ] Section 2: ROI Card + TimeBudgetIndicator side-by-side
  - [ ] Section 3: ProjectTimeBreakdown (full width)
  - [ ] Section 4: HistoricalTimeTrend (full width, collapsible)
  - [ ] Section 5: LabelTimeBreakdown (full width)
  - [ ] Zero-time alert banner if applicable (dismissible)
  - [ ] Add "View All Businesses" link to Business Comparison page
  - [ ] Responsive design: stack sections vertically on mobile
  - [ ] Loading states for all components

## Dev Notes

### Previous Story Insights
**From Story 4.1:** [Source: docs/stories/4.1.deep-work-time-allocation-calculation.md]
- deep_work_sessions table created with business_id, life_area_id, project_id, task_id, labels
- Time aggregation SQL functions established (daily, weekly, monthly)
- useDeepWorkSessions hook with React Query for CRUD operations
- Real-time sync infrastructure via useRealtimeSync
- CSV export utility pattern for time data

**From Epic 1 Stories:** [Source: docs/stories/1.2-1.3]
- Business page structure exists with bidirectional task sync
- businesses table has id, name, slug, color, description
- Business detail page shows projects and tasks
- Navigation to Business pages via slug

**From Epic 2 Stories:** [Source: docs/stories/2.3-2.4]
- Project-level progress visualization patterns established
- Business area progress dashboard aggregates project data
- Recharts integration for visual analytics
- Color-coded progress indicators

**Key Technical Context:**
- This is the SECOND story in Epic 4 - builds on Story 4.1's deep_work_sessions foundation
- Business page becomes primary hub for time investment insights
- ROI tracking requires revenue data (businesses.revenue_current_month)
- Time budgets stored per business for target vs. actual comparisons
- Zero-time alerts prevent business neglect

### Architecture Context

**Tech Stack:** [Source: docs/ui-architecture/2-frontend-tech-stack.md]
- React 19.1.1 + TypeScript 5.9.3
- TanStack Query 5.90.2 for caching time stats
- Recharts for pie charts, bar charts, line charts
- date-fns 4.1.0 for date range calculations
- Lucide React 0.544.0 for alert icons

**Database Schema Updates**
```sql
-- Add revenue tracking and time budget columns to businesses table
ALTER TABLE businesses ADD COLUMN revenue_current_month NUMERIC DEFAULT 0;
ALTER TABLE businesses ADD COLUMN time_budget_hours_per_week INTEGER DEFAULT NULL;

-- Create index for time allocation queries
CREATE INDEX IF NOT EXISTS idx_deep_work_business_start
  ON deep_work_sessions(business_id, start_time);

-- Create materialized view for fast business time stats (refreshed hourly)
CREATE MATERIALIZED VIEW business_time_stats AS
SELECT
  business_id,
  -- All-time hours
  SUM(duration_minutes) / 60.0 as total_hours,
  -- This week
  SUM(CASE WHEN start_time >= date_trunc('week', NOW()) THEN duration_minutes ELSE 0 END) / 60.0 as hours_this_week,
  -- This month
  SUM(CASE WHEN start_time >= date_trunc('month', NOW()) THEN duration_minutes ELSE 0 END) / 60.0 as hours_this_month,
  -- Last 4 weeks average
  SUM(CASE WHEN start_time >= NOW() - INTERVAL '4 weeks' THEN duration_minutes ELSE 0 END) / 60.0 / 4 as avg_hours_per_week,
  -- Last session date
  MAX(start_time) as last_session_date
FROM deep_work_sessions
WHERE business_id IS NOT NULL
GROUP BY business_id;

CREATE UNIQUE INDEX ON business_time_stats(business_id);

-- Refresh materialized view function (call from scheduled job)
CREATE OR REPLACE FUNCTION refresh_business_time_stats()
RETURNS void AS $$
BEGIN
  REFRESH MATERIALIZED VIEW CONCURRENTLY business_time_stats;
END;
$$ LANGUAGE plpgsql;
```

**Business Time Stats Query Pattern**
```sql
-- Get comprehensive time stats for a business
CREATE OR REPLACE FUNCTION get_business_time_stats(p_business_id UUID)
RETURNS JSONB AS $$
  SELECT jsonb_build_object(
    'total_hours', COALESCE(SUM(dws.duration_minutes) / 60.0, 0),
    'hours_this_week', COALESCE(SUM(
      CASE WHEN dws.start_time >= date_trunc('week', NOW())
      THEN dws.duration_minutes ELSE 0 END
    ) / 60.0, 0),
    'hours_this_month', COALESCE(SUM(
      CASE WHEN dws.start_time >= date_trunc('month', NOW())
      THEN dws.duration_minutes ELSE 0 END
    ) / 60.0, 0),
    'avg_hours_per_week', COALESCE(SUM(
      CASE WHEN dws.start_time >= NOW() - INTERVAL '4 weeks'
      THEN dws.duration_minutes ELSE 0 END
    ) / 60.0 / 4, 0),
    'last_session_date', MAX(dws.start_time),
    'days_since_last_session', EXTRACT(DAY FROM NOW() - MAX(dws.start_time))
  )
  FROM deep_work_sessions dws
  WHERE dws.business_id = p_business_id;
$$ LANGUAGE SQL STABLE;

-- Project time breakdown query
CREATE OR REPLACE FUNCTION get_project_time_breakdown(
  p_business_id UUID,
  p_start_date DATE DEFAULT NULL,
  p_end_date DATE DEFAULT NULL
)
RETURNS TABLE(
  project_id UUID,
  project_name TEXT,
  hours NUMERIC
) AS $$
  SELECT
    p.id as project_id,
    p.name as project_name,
    ROUND(SUM(dws.duration_minutes) / 60.0, 2) as hours
  FROM deep_work_sessions dws
  LEFT JOIN projects p ON dws.project_id = p.id
  WHERE dws.business_id = p_business_id
    AND (p_start_date IS NULL OR DATE(dws.start_time) >= p_start_date)
    AND (p_end_date IS NULL OR DATE(dws.start_time) <= p_end_date)
  GROUP BY p.id, p.name
  ORDER BY hours DESC;
$$ LANGUAGE SQL STABLE;

-- Label time breakdown query
CREATE OR REPLACE FUNCTION get_label_time_breakdown(
  p_business_id UUID,
  p_start_date DATE DEFAULT NULL
)
RETURNS TABLE(
  label TEXT,
  hours NUMERIC
) AS $$
  SELECT
    UNNEST(labels) as label,
    ROUND(SUM(duration_minutes) / 60.0, 2) as hours
  FROM deep_work_sessions
  WHERE business_id = p_business_id
    AND (p_start_date IS NULL OR DATE(start_time) >= p_start_date)
  GROUP BY label
  ORDER BY hours DESC;
$$ LANGUAGE SQL STABLE;
```

**React Query Hooks Pattern**
```typescript
// src/hooks/useBusinessTimeStats.ts
import { useQuery } from '@tanstack/react-query';
import { supabase } from '@/lib/supabase';

export const useBusinessTimeStats = (businessId: string) => {
  return useQuery({
    queryKey: ['business-time-stats', businessId],
    queryFn: async () => {
      const { data, error } = await supabase.rpc('get_business_time_stats', {
        p_business_id: businessId,
      });

      if (error) throw error;
      return data as {
        total_hours: number;
        hours_this_week: number;
        hours_this_month: number;
        avg_hours_per_week: number;
        last_session_date: string;
        days_since_last_session: number;
      };
    },
    staleTime: 5 * 60 * 1000, // 5 minutes
    refetchInterval: 5 * 60 * 1000, // Auto-refetch every 5 min
  });
};

export const useProjectTimeBreakdown = (businessId: string, dateRange?: { start: Date; end: Date }) => {
  return useQuery({
    queryKey: ['project-time-breakdown', businessId, dateRange],
    queryFn: async () => {
      const { data, error } = await supabase.rpc('get_project_time_breakdown', {
        p_business_id: businessId,
        p_start_date: dateRange?.start.toISOString().split('T')[0],
        p_end_date: dateRange?.end.toISOString().split('T')[0],
      });

      if (error) throw error;
      return data as Array<{
        project_id: string;
        project_name: string;
        hours: number;
      }>;
    },
  });
};

export const useBusinessROI = (businessId: string) => {
  return useQuery({
    queryKey: ['business-roi', businessId],
    queryFn: async () => {
      // Get time stats
      const { data: timeStats, error: timeError } = await supabase.rpc('get_business_time_stats', {
        p_business_id: businessId,
      });
      if (timeError) throw timeError;

      // Get revenue
      const { data: business, error: bizError } = await supabase
        .from('businesses')
        .select('revenue_current_month')
        .eq('id', businessId)
        .single();
      if (bizError) throw bizError;

      const revenue = business.revenue_current_month || 0;
      const hours = timeStats.hours_this_month || 0;
      const effectiveRate = hours > 0 ? revenue / hours : 0;

      return {
        revenue,
        hours,
        effectiveRate,
      };
    },
    staleTime: 5 * 60 * 1000,
  });
};
```

**Component Patterns**
```typescript
// src/components/business/TimeInvestedCard.tsx
import { TrendingUp, TrendingDown } from 'lucide-react';
import { useBusinessTimeStats } from '@/hooks/useBusinessTimeStats';

interface TimeInvestedCardProps {
  businessId: string;
}

export const TimeInvestedCard: React.FC<TimeInvestedCardProps> = ({ businessId }) => {
  const { data: stats, isLoading } = useBusinessTimeStats(businessId);

  if (isLoading) return <div>Loading...</div>;

  const metrics = [
    { label: 'All-Time', value: `${stats.total_hours.toFixed(1)}h` },
    { label: 'This Week', value: `${stats.hours_this_week.toFixed(1)}h`, primary: true },
    { label: 'This Month', value: `${stats.hours_this_month.toFixed(1)}h` },
    { label: 'Avg/Week', value: `${stats.avg_hours_per_week.toFixed(1)}h` },
  ];

  return (
    <div className="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h3 className="text-lg font-semibold mb-4">Time Invested</h3>
      <div className="grid grid-cols-4 gap-4">
        {metrics.map(metric => (
          <div key={metric.label} className={metric.primary ? 'bg-blue-50 p-3 rounded' : ''}>
            <div className="text-sm text-gray-600">{metric.label}</div>
            <div className={`text-2xl font-bold ${metric.primary ? 'text-blue-600' : ''}`}>
              {metric.value}
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// src/components/business/ROICard.tsx
export const ROICard: React.FC<{ businessId: string }> = ({ businessId }) => {
  const { data: roi } = useBusinessROI(businessId);

  const rateColor = roi.effectiveRate >= 150 ? 'text-green-600'
    : roi.effectiveRate >= 75 ? 'text-yellow-600'
    : 'text-red-600';

  return (
    <div className="bg-white rounded-lg shadow p-6">
      <h3 className="text-lg font-semibold mb-2">ROI This Month</h3>
      <div className="text-sm text-gray-600">
        {roi.hours.toFixed(1)}h invested, ${roi.revenue.toLocaleString()} revenue
      </div>
      <div className={`text-3xl font-bold ${rateColor}`}>
        ${roi.effectiveRate.toFixed(0)}/hour
      </div>
    </div>
  );
};

// src/components/business/ZeroTimeAlert.tsx
export const ZeroTimeAlert: React.FC<{ businessId: string, daysSince: number }> = ({
  businessId,
  daysSince,
}) => {
  if (daysSince < 7) return null;

  return (
    <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
      <div className="flex items-center">
        <AlertTriangle className="text-yellow-600 mr-3" />
        <div>
          <p className="font-semibold text-yellow-800">
            ⚠️ No time allocated this week
          </p>
          <p className="text-sm text-yellow-700">
            Last session was {daysSince} days ago
          </p>
        </div>
        <button className="ml-auto bg-yellow-500 text-white px-4 py-2 rounded">
          Schedule Time
        </button>
      </div>
    </div>
  );
};
```

**File Locations:**
- Update: supabase-tasks-hub-schema.sql (add columns to businesses)
- Create: supabase-business-time-stats.sql (materialized view and functions)
- Create: src/hooks/useBusinessTimeStats.ts (time stats hooks)
- Create: src/hooks/useBusinessROI.ts (ROI calculation hooks)
- Create: src/components/business/TimeInvestedCard.tsx
- Create: src/components/business/ROICard.tsx
- Create: src/components/business/TimeBudgetIndicator.tsx
- Create: src/components/business/ProjectTimeBreakdown.tsx
- Create: src/components/business/HistoricalTimeTrend.tsx
- Create: src/components/business/LabelTimeBreakdown.tsx
- Create: src/components/business/ZeroTimeAlert.tsx
- Create: src/pages/BusinessComparison.tsx
- Update: src/pages/Business.tsx (integrate new components)

### Testing

**Testing Requirements:** [Source: docs/prd/technical-assumptions.md]
Manual testing with systematic verification (no automated test suite per PRD)

**Business Time Investment Validation Workflow:**
1. **Database Schema Verification:**
   - Run ALTER TABLE commands to add revenue_current_month and time_budget_hours_per_week
   - Verify columns added: SELECT * FROM businesses LIMIT 1
   - Test materialized view: SELECT * FROM business_time_stats
   - Refresh materialized view: SELECT refresh_business_time_stats()

2. **TimeInvestedCard Testing:**
   - Create 5 Deep Work sessions for Full Stack AI: 2h on Monday, 3h on Tuesday, etc.
   - Navigate to Full Stack AI Business page
   - Verify TimeInvestedCard shows: This Week = 5h (sum of sessions)
   - Verify This Month includes all sessions this month
   - Verify Avg/Week calculates correctly (last 4 weeks / 4)
   - Verify All-Time includes sessions from previous months

3. **Project Time Breakdown Testing:**
   - Create Deep Work sessions for 3 projects within Full Stack AI: Project A (5h), Project B (3h), Project C (2h)
   - Verify pie chart shows 3 slices with correct proportions
   - Switch to bar chart view → verify horizontal bars match hours
   - Click Project A slice → verify navigates to Project A detail page
   - Filter by "This Week" → verify only shows this week's hours per project

4. **ROI Tracking Testing:**
   - Set revenue for Huge Capital: Update businesses.revenue_current_month = 5000
   - Create 45h of Deep Work sessions for Huge Capital this month
   - Verify ROICard shows: "45h, $5,000 revenue = $111/hour"
   - Verify color: $111/h should be yellow (between $75-150)
   - Test edge cases: 0 revenue → shows "No revenue tracked", 0 hours → shows "No time logged"

5. **Zero-Time Alert Testing:**
   - Business with no sessions in 7 days: set last session date to 10 days ago
   - Navigate to that Business page
   - Verify yellow alert banner appears: "⚠️ No time allocated this week, Last session was 10 days ago"
   - Click "Schedule Time" button → verify navigates to Daily page with business pre-selected
   - Dismiss alert → verify hidden, reload page within 24h → verify stays hidden

6. **Business Comparison View Testing:**
   - Navigate to /business-comparison
   - Verify table shows all 5 businesses with time stats
   - Verify bars show relative time investment (Full Stack AI longest bar if most hours)
   - Sort by "Most Hours" → verify Full Stack AI at top
   - Sort by "Least Hours" → verify business with fewest hours at top
   - Verify total row sums all business hours correctly
   - Export as CSV → verify contains all businesses and time stats

7. **Time Budget Testing:**
   - Set time budget for Full Stack AI: 10h/week
   - Create 8h of sessions this week
   - Verify TimeBudgetIndicator shows: "Target: 10h/week, Actual: 8h (80%)" with yellow progress bar
   - Add 3h more sessions (total 11h)
   - Verify progress bar turns green (110% of target)
   - Test <75% scenario → verify red progress bar

8. **Historical Time Trend Testing:**
   - Create sessions across last 90 days with varying daily hours
   - Verify HistoricalTimeTrend line chart renders with smooth curve
   - Hover over line → verify tooltip shows date and exact hours
   - Switch aggregation from daily to weekly → verify chart updates to weekly totals
   - Export chart as PNG → verify downloads correctly

9. **Label Time Breakdown Testing:**
   - Create sessions with various labels: "Internal Build" (10h), "$$$ Printer $$$" (15h), "Bug Fix" (5h)
   - Verify LabelTimeBreakdown bar chart shows labels ordered by hours ($$$ highest)
   - Verify revenue labels ($$$) colored green
   - Filter by "This Month" → verify only this month's label hours shown
   - Click "$$$ Printer $$$" bar → verify filters sessions to show only that label

10. **Integration Testing:**
    - Full workflow: Start Deep Work timer → work 2h on Full Stack AI → stop timer
    - Navigate to Full Stack AI Business page
    - Verify TimeInvestedCard immediately shows +2h this week (real-time update)
    - Verify ProjectTimeBreakdown updates if project was linked
    - Verify HistoricalTimeTrend adds data point for today
    - Open second tab → verify all components show updated data within 500ms

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-07 | v1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
_To be populated by development agent_

### Debug Log References
_To be populated by development agent_

### Completion Notes List
_To be populated by development agent_

### File List
_To be populated by development agent_

## QA Results
_To be populated by QA agent_
